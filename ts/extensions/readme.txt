unofficial implementation based on ts
